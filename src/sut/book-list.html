<link rel="import" href="/lib/nclk/hoquet.html">
<link rel="import" href="/src/sut/book.html">

<template class="BookList">
    <style>
        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
    </style>
    <ul></ul>
</template>

<script>
((global) => {

    const _import = global.Sut._resolveImport("src/sut/book-list.html");

    class BookList extends Nclk.Hoquet(HTMLElement) {
        constructor(books) {
            super();
            if (books) {
                this._setModel(books);
            }
        }

        static get import() {
            return _import;
        }

        _setModel(books) {
            if (this.model !== books) {
                Object.defineProperty(this, "model", {
                    value: books,
                    writable: true
                });
                this.render();
            }
        }

        set model(books) {
            this._setModel(books);
        }

        render() {
            super.render()
            this.$ul = this.shadowRoot.querySelector("ul");
            this.model.forEach(book => this.appendBook(book));
        }

        appendBook(book) {
            let $li = document.createElement("li");
            let $book = new Sut.Book(book);
            $li.append($book);
            this.$ul.appendChild($li);
        }

        removeBook(idx) {
            this.model.splice(idx, 1);
            this.$ul.removeChild(this.$ul.childNodes[idx]);
        }

    }

    global.Sut.BookList = BookList;
    global.customElements.define("sut-book-list", BookList);

})(this);
</script>
